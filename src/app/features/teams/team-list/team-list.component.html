<mat-card class="team-list-card">
  <div class="card-header">Teams</div>
  <div class="teams-scroll">
    <mat-accordion multi>
      @for (team of teams; track team.id) {
        <mat-expansion-panel [expanded]="panelOpenState[team.id]" (opened)="panelOpenState[team.id]=true; onSelect(team)" (closed)="panelOpenState[team.id]=false">
          <mat-expansion-panel-header>
            <mat-panel-title>{{ team.name }}</mat-panel-title>
            <mat-panel-description>{{ team.members.length }} member{{ team.members.length === 1 ? '' : 's' }}</mat-panel-description>
          </mat-expansion-panel-header>

          <div class="team-members">
            @for (m of team.members; track m.id) {
              <div class="member-row">
                @if (m.avatarUrl) {
                  <div class="avatar"><img [src]="m.avatarUrl" [alt]="m.name" /></div>
                } @else {
                  <div class="avatar placeholder">{{ m.name.charAt(0) }}</div>
                }
                <div class="info">
                  <div class="name">{{ m.name }}</div>
                  <div class="role">{{ m.role }}</div>
                </div>
              </div>
            } @empty {
              <div class="empty">No members.</div>
            }
          </div>
        </mat-expansion-panel>
      } @empty {
        <div class="empty">No teams yet.</div>
      }
    </mat-accordion>
  </div>
</mat-card>
